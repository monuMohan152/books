<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Educational Materials Repository</title>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>

    <style>
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
    
        body {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
          background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%);
          min-height: 100vh;
          color: #1f2937;
          padding: 20px;
          animation: gradientShift 10s ease infinite;
        }
    
        @keyframes gradientShift {
          0%, 100% { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%); }
          50% { background: linear-gradient(135deg, #3b82f6 0%, #6366f1 50%, #8b5cf6 100%); }
        }
    
        .container {
              position: relative;
              z-index: 1;
        }
        .header {
          text-align: center;
          background: rgba(255, 255, 255, 0.95);
          backdrop-filter: blur(20px);
          padding: 40px 30px;
          border-radius: 24px;
          box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
          margin-bottom: 30px;
          border: 1px solid rgba(255, 255, 255, 0.2);
        }
    
        .header h1 {
          font-size: 3rem;
          background: linear-gradient(135deg, #6366f1, #8b5cf6, #ec4899);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          font-weight: 800;
          margin-bottom: 15px;
          letter-spacing: -0.02em;
        }
    
        .header p {
          font-size: 1.2rem;
          color: #6b7280;
          margin-bottom: 30px;
          font-weight: 500;
        }
    
        .search-container {
          position: relative;
          max-width: 600px;
          margin: 0 auto 30px;
        }
    
        .search-box {
          width: 100%;
          padding: 16px 100px 16px 24px;
          border-radius: 16px;
          border: 2px solid rgba(99, 102, 241, 0.1);
          font-size: 1.1rem;
          background: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(10px);
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
          transition: all 0.3s ease;
          outline: none;
        }
    
        .search-box:focus {
          border-color: #6366f1;
          box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
          transform: translateY(-2px);
        }
    
        .voice-btn {
          position: absolute;
          right: 60px;
          top: 50%;
          transform: translateY(-50%);
          background: linear-gradient(135deg, #6366f1, #8b5cf6);
          color: white;
          border: none;
          border-radius: 10px;
          padding: 8px 12px;
          font-size: 1.1rem;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 2px 10px rgba(99, 102, 241, 0.3);
        }
    
        .voice-btn:hover {
          transform: translateY(-50%) scale(1.1);
          box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        }
    
        .voice-btn.listening {
          background: linear-gradient(135deg, #ef4444, #f97316);
          animation: pulse 1.5s ease-in-out infinite;
        }
    
        .voice-btn.processing {
          background: linear-gradient(135deg, #f59e0b, #eab308);
        }
    
        @keyframes pulse {
          0%, 100% {
            transform: translateY(-50%) scale(1);
            box-shadow: 0 2px 10px rgba(99, 102, 241, 0.3);
          }
          50% {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.5);
          }
        }
    
        .search-icon {
          position: absolute;
          right: 20px;
          top: 50%;
          transform: translateY(-50%);
          font-size: 1.3rem;
          color: #6366f1;
        }
    
        .filters-section {
          margin-bottom: 25px;
        }
    
            .filters {
              display: flex;
              flex-wrap: wrap;
              justify-content: center;
              gap: 12px;
              margin-bottom: 20px;
              max-height: 200px;
              overflow-y: auto;
              padding: 10px;
            }
    
            .filter-btn {
              padding: 12px 20px;
              border: 2px solid rgba(99, 102, 241, 0.3);
              border-radius: 12px;
              background: rgba(255, 255, 255, 0.9);
              backdrop-filter: blur(10px);
              color: #6366f1;
              font-weight: 600;
              font-size: 0.9rem;
              cursor: pointer;
              transition: all 0.3s ease;
              white-space: nowrap;
              text-align: center;
              min-width: 80px;
              box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            }
    
        .filter-btn:hover {
          background: linear-gradient(135deg, #6366f1, #8b5cf6);
          color: white;
          transform: translateY(-2px);
          box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
          border-color: transparent;
        }
    
        .filter-btn.active {
          background: linear-gradient(135deg, #6366f1, #8b5cf6);
          color: white;
          border-color: transparent;
          box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }
    
        .refresh-btn {
          display: block;
          margin: 20px auto 0;
          padding: 14px 28px;
          background: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(10px);
          border: 2px solid rgba(99, 102, 241, 0.3);
          border-radius: 14px;
          color: #6366f1;
          font-weight: 600;
          font-size: 1rem;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
    
        .refresh-btn:hover {
          background: linear-gradient(135deg, #6366f1, #8b5cf6);
          color: white;
          transform: translateY(-2px);
          box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
          border-color: transparent;
        }
    
        .stats {
          text-align: center;
          padding: 20px;
          background: rgba(255, 255, 255, 0.15);
          backdrop-filter: blur(20px);
          border-radius: 20px;
          color: white;
          border: 1px solid rgba(255, 255, 255, 0.2);
        }
    
        .stats h3 {
          font-size: 2.5rem;
          font-weight: 800;
          margin-bottom: 8px;
        }
    
        .stats p {
          font-size: 1.1rem;
          font-weight: 500;
          opacity: 0.9;
        }
    
        .materials-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
          gap: 25px;
          margin-top: 30px;
        }
    
        .material-card {
          background: rgba(255, 255, 255, 0.95);
          backdrop-filter: blur(20px);
          padding: 30px;
          border-radius: 20px;
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
          transition: all 0.3s ease;
          border: 1px solid rgba(255, 255, 255, 0.2);
          position: relative;
          overflow: hidden;
        }
    
        .material-card::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 4px;
          background: linear-gradient(135deg, #6366f1, #8b5cf6, #ec4899);
        }
    
        .material-card:hover {
          transform: translateY(-8px);
          box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }
    
        .material-title {
          font-size: 1.3rem;
          font-weight: 700;
          margin-bottom: 12px;
          color: #1f2937;
          line-height: 1.4;
        }
    
        .material-description {
          font-size: 1rem;
          color: #6b7280;
          margin-bottom: 20px;
          line-height: 1.6;
        }
    
        .material-topics {
          display: flex;
          flex-wrap: wrap;
          gap: 8px;
          margin-bottom: 20px;
        }
    
        .topic-tag {
          background: linear-gradient(135deg, #6366f1, #8b5cf6);
          color: white;
          padding: 6px 12px;
          border-radius: 8px;
          font-size: 0.8rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
    
        .material-link {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          background: linear-gradient(135deg, #6366f1, #8b5cf6);
          color: white;
          padding: 14px 24px;
          border-radius: 12px;
          text-decoration: none;
          font-weight: 700;
          font-size: 0.95rem;
          transition: all 0.3s ease;
          box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }
    
        .material-link:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
          background: linear-gradient(135deg, #5b5bd6, #7c3aed);
        }
    
        .loading, .no-results {
          text-align: center;
          color: white;
          padding: 60px 20px;
        }
    
        .loading h3, .no-results h3 {
          font-size: 1.5rem;
          margin-bottom: 10px;
          font-weight: 600;
        }
    
        .loading p, .no-results p {
          font-size: 1.1rem;
          opacity: 0.8;
        }
    
        .spinner {
          width: 50px;
          height: 50px;
          border: 4px solid rgba(255, 255, 255, 0.3);
          border-top: 4px solid white;
          border-radius: 50%;
          animation: spin 1s linear infinite;
          margin: 0 auto 25px;
        }
    
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
    
        /* Responsive Design */
        @media (max-width: 768px) {
          .header h1 {
            font-size: 2.2rem;
          }
          
          .header p {
            font-size: 1rem;
          }
          
          .search-box {
            padding: 16px 90px 16px 20px;
            font-size: 1rem;
          }
          
          .voice-btn {
            right: 50px;
            padding: 6px 10px;
            font-size: 1rem;
          }
          
          .filters {
            max-height: 150px;
            gap: 8px;
          }
          
          .filter-btn {
            padding: 10px 16px;
            font-size: 0.85rem;
          }
          
          .materials-grid {
            grid-template-columns: 1fr;
            gap: 20px;
          }
          
          .material-card {
            padding: 25px;
          }
          .material-title,
            .material-description {
              font-size: 1rem;
              word-break: break-word;
            }
    
            .filter-btn {
              min-width: unset; /* remove rigid width */
              max-width: 100%;
              white-space: normal; /* allow wrapping */
              word-break: break-word;
            }
    
        }
    
        /* Custom scrollbar for filters */
        .filters::-webkit-scrollbar {
          width: 6px;
        }
    
        .filters::-webkit-scrollbar-track {
          background: rgba(255, 255, 255, 0.1);
          border-radius: 3px;
        }
    
        .filters::-webkit-scrollbar-thumb {
          background: rgba(255, 255, 255, 0.3);
          border-radius: 3px;
        }
    
        .filters::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>

<body>
    <div id="particles-js" style="position: fixed; width: 100%; height: 100%; z-index: -1;"></div>
    <div class="container">
        <div class="header">
            <h1>📚 Knowledge Keepers</h1>
            <p>Discover and access comprehensive educational resources</p>

            <div class="search-container">
                <input type="text" id="searchBox" class="search-box" placeholder="Search materials by name, keywords, description, or topics...">
                <button id="voiceBtn" class="voice-btn" title="Click to speak your search">🎤</button>
                <span class="search-icon">🔍</span>
            </div>

            <div class="filters-section">
                <div class="filters" id="filters">
                    <button class="filter-btn active" data-filter="all">All Materials</button>
                </div>

                <button onclick="reloadMaterials()" class="refresh-btn">
                    🔄 Refresh Materials
                </button>
            </div>
        </div>

        <div class="stats">
            <h3 id="materialCount">0</h3>
            <p>Educational Materials Available</p>
        </div>

        <div id="materialsContainer">
            <div class="loading">
                <div class="spinner"></div>
                <h3>Loading Materials</h3>
                <p>Please wait while we fetch the latest educational resources...</p>
            </div>
        </div>
    </div>

    <script>
        let materials = [];
        let filteredMaterials = [];
        let currentFilter = 'all';
        let recognition = null;
        let isListening = false;
        
        function init() {
          loadMaterials();
          setupSearchListener();
          setupVoiceRecognition();
        }

        function highlightTerms(text, query) {
          const regex = new RegExp(`(${query})`, "gi");
          return text.replace(regex, `<mark>$1</mark>`);
        }
        async function loadMaterials() {
          const githubCSVUrl = "https://raw.githubusercontent.com/monuMohan152/books/main/Data.csv";
          try {
            showLoading();
            const response = await fetch(githubCSVUrl);
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            const csvData = await response.text();
            materials = parseCSVData(csvData);
            console.log(`Loaded ${materials.length} materials`);
          } catch (error) {
            console.error('Failed to load CSV from GitHub:', error);
            showError('Failed to load materials. Please try refreshing the page.');
            materials = [];
          }
        
          generateFilters();
          filteredMaterials = [...materials];
          displayMaterials();
          updateStats();
        }
        
        function showLoading() {
          const container = document.getElementById('materialsContainer');
          container.innerHTML = `
            <div class="loading">
              <div class="spinner"></div>
              <h3>Loading Materials</h3>
              <p>Please wait while we fetch the latest educational resources...</p>
            </div>
          `;
        }
        
        function showError(message) {
          const container = document.getElementById('materialsContainer');
          container.innerHTML = `
            <div class="no-results">
              <h3>⚠️ Error Loading Materials</h3>
              <p>${message}</p>
            </div>
          `;
        }
        
        function parseCSVData(data) {
          const lines = data.trim().split("\n");
          if (lines.length === 0) return [];
          
          const headers = lines[0].split(",").map(h => h.trim().replace(/"/g, ''));
          console.log('CSV Headers:', headers);
        
          return lines.slice(1).map((line, index) => {
            try {
              const values = parseCSVLine(line);
              const entry = {};
              
              headers.forEach((header, idx) => {
                entry[header] = values[idx] || '';
              });
        
              const material = {
                title: entry["Document Name"] || `Document ${index + 1}`,
                description: entry["Document Description"] || "No description available",
                url: entry["Document Link"] || "#",
                topics: [
                  entry["Search Keywords"],
                  entry["Document Topic"],
                  entry["Document Topic 1"],
                  entry["Document Topic 2"],
                  entry["Document Topic 3"],
                ].filter(topic => topic && topic.trim() && topic !== "").map(t => t.trim())
              };
        
              return material;
            } catch (error) {
              console.warn(`Error parsing line ${index + 1}:`, error);
              return null;
            }
          }).filter(material => material !== null);
        }
        
        function parseCSVLine(line) {
          const values = [];
          let current = '';
          let inQuotes = false;
          
          for (let i = 0; i < line.length; i++) {
            const char = line[i];
            
            if (char === '"') {
              inQuotes = !inQuotes;
            } else if (char === ',' && !inQuotes) {
              values.push(current.trim().replace(/"/g, ''));
              current = '';
            } else {
              current += char;
            }
          }
          
          values.push(current.trim().replace(/"/g, ''));
          return values;
        }
        
        function generateFilters() {
          const allTopics = new Set();
          materials.forEach(material => {
            material.topics.forEach(topic => {
              if (topic && topic.trim()) {
                allTopics.add(topic.trim());
              }
            });
          });
        
          const filtersContainer = document.getElementById('filters');
          filtersContainer.innerHTML = '';
        
          // Add "All Materials" button
          const allButton = document.createElement('button');
          allButton.className = 'filter-btn active';
          allButton.setAttribute('data-filter', 'all');
          allButton.textContent = 'All Materials';
          allButton.addEventListener('click', handleFilterClick);
          filtersContainer.appendChild(allButton);
        
          // Add topic filter buttons
          Array.from(allTopics).sort().forEach(topic => {
            const button = document.createElement('button');
            button.className = 'filter-btn';
            button.setAttribute('data-filter', topic);
            button.textContent = topic;
            button.addEventListener('click', handleFilterClick);
            filtersContainer.appendChild(button);
          });
        }
        
        function setupSearchListener() {
          const searchBox = document.getElementById('searchBox');
          searchBox.addEventListener('input', debounce(handleSearch, 300));
        }
        
        function setupVoiceRecognition() {
          const voiceBtn = document.getElementById('voiceBtn');
          
          // Check if browser supports speech recognition
          if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
            voiceBtn.style.display = 'none';
            console.log('Speech recognition not supported in this browser');
            return;
          }
        
          // Initialize speech recognition
          const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
          recognition = new SpeechRecognition();
          
          recognition.continuous = false;
          recognition.interimResults = false;
          recognition.lang = 'en-US';
        
          voiceBtn.addEventListener('click', toggleVoiceRecognition);
        
          recognition.onstart = () => {
            isListening = true;
            voiceBtn.classList.add('listening');
            voiceBtn.title = 'Listening... Click to stop';
            console.log('Voice recognition started');
          };
        
          recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            console.log('Voice input:', transcript);
            
            const searchBox = document.getElementById('searchBox');
            searchBox.value = transcript;
            
            // Trigger search
            handleSearch({ target: searchBox });
            
            // Visual feedback
            voiceBtn.classList.remove('listening');
            voiceBtn.classList.add('processing');
            setTimeout(() => {
              voiceBtn.classList.remove('processing');
            }, 1000);
          };
        
          recognition.onerror = (event) => {
            console.error('Speech recognition error:', event.error);
            isListening = false;
            voiceBtn.classList.remove('listening', 'processing');
            voiceBtn.title = 'Click to speak your search';
            
            // Show user-friendly error messages
            let errorMessage = 'Voice recognition error. ';
            switch(event.error) {
              case 'no-speech':
                errorMessage += 'No speech detected. Please try again.';
                break;
              case 'network':
                errorMessage += 'Network error. Check your connection.';
                break;
              case 'not-allowed':
                errorMessage += 'Microphone access denied. Please allow microphone access.';
                break;
              default:
                errorMessage += 'Please try again.';
            }
            
            // You could add a toast notification here if desired
            console.log(errorMessage);
          };
        
          recognition.onend = () => {
            isListening = false;
            voiceBtn.classList.remove('listening');
            voiceBtn.title = 'Click to speak your search';
            console.log('Voice recognition ended');
          };
        }
        
        function toggleVoiceRecognition() {
          if (!recognition) return;
          
          if (isListening) {
            recognition.stop();
          } else {
            recognition.start();
          }
        }
        
        function handleSearch(event) {
          const query = event.target.value.toLowerCase().trim();
          filteredMaterials = materials.filter(material => {
            const matchesSearch = !query || (
              material.title.toLowerCase().includes(query) ||
              material.description.toLowerCase().includes(query) ||
              material.topics.some(topic => topic.toLowerCase().includes(query))
            );
        
            const matchesFilter = currentFilter === 'all' || material.topics.includes(currentFilter);
            return matchesSearch && matchesFilter;
          });
        
          displayMaterials();
          updateStats();
        }
        
        function handleFilterClick(event) {
          currentFilter = event.target.getAttribute('data-filter');
          
          // Update active state
          document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
          event.target.classList.add('active');
          
          // Trigger search with current filter
          const searchBox = document.getElementById('searchBox');
          handleSearch({ target: searchBox });
        }
        
        function displayMaterials() {
          const container = document.getElementById('materialsContainer');
        
          if (filteredMaterials.length === 0) {
            container.innerHTML = `
              <div class="no-results">
                <h3>📭 No Materials Found</h3>
                <p>Try adjusting your search criteria or filters to find what you're looking for.</p>
              </div>
            `;
            return;
          }
        
          const grid = document.createElement('div');
          grid.className = 'materials-grid';
        
          filteredMaterials.forEach(material => {
            const card = createMaterialCard(material);
            grid.appendChild(card);
          });
        
          container.innerHTML = '';
          container.appendChild(grid);
        }
        
        function createMaterialCard(material) {
          const card = document.createElement('div');
          card.className = 'material-card';
        
          const topicsHTML = material.topics
            .filter(topic => topic && topic.trim())
            .slice(0, 5) // Limit to first 5 topics to avoid overcrowding
            .map(topic => `<span class="topic-tag">${topic}</span>`)
            .join('');
        
          card.innerHTML = `
            <h3 class="material-title">${escapeHtml(material.title)}</h3>
            <p class="material-description">${escapeHtml(material.description)}</p>
            <div class="material-topics">${topicsHTML}</div>
            <a href="${material.url}" target="_blank" rel="noopener noreferrer" class="material-link">
              📖 Access Material <span style="font-size: 0.9rem;">↗</span>
            </a>
          `;
          return card;
        }
        
        function escapeHtml(text) {
          const div = document.createElement('div');
          div.textContent = text;
          return div.innerHTML;
        }
        
        function updateStats() {
          const count = document.getElementById('materialCount');
          count.textContent = filteredMaterials.length.toLocaleString();
        }
        
        function debounce(func, wait) {
          let timeout;
          return function (...args) {
            clearTimeout(timeout);
            timeout = setTimeout(() => func(...args), wait);
          };
        }
        
        function reloadMaterials() {
          currentFilter = 'all';
          document.getElementById('searchBox').value = '';
          loadMaterials();
        }
        
        // Initialize the application
        init();
    </script>
    <script>
        particlesJS('particles-js', {
          "particles": {
            "number": { "value": 80, "density": { "enable": true, "value_area": 800 } },
            "color": { "value": "#ffffff" },
            "shape": { "type": "circle" },
            "opacity": { "value": 0.3, "random": true },
            "size": { "value": 4, "random": true },
            "line_linked": {
              "enable": true,
              "distance": 150,
              "color": "#ffffff",
              "opacity": 0.2,
              "width": 1
            },
            "move": {
              "enable": true,
              "speed": 2,
              "direction": "none",
              "random": false,
              "out_mode": "out"
            }
          },
          "interactivity": {
            "events": {
              "onhover": { "enable": true, "mode": "grab" },
              "onclick": { "enable": true, "mode": "push" }
            },
            "modes": {
              "grab": { "distance": 200, "line_linked": { "opacity": 0.3 } },
              "push": { "particles_nb": 4 }
            }
          },
          "retina_detect": true
        });
    </script>

</body>

</html>
